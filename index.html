<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>LinkedIn Noir & Blanc</title>
  <style>
    :root { --bg:#0b0f14; --card:#111827; --muted:#94a3b8; --text:#e5e7eb; --accent:#60a5fa; }
    body { margin:0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial; background:linear-gradient(180deg,#05070a,#0b0f14); color:var(--text); }
    .wrap { max-width: 900px; margin: 40px auto; padding: 0 16px; }
    .card { background: rgba(17,24,39,.9); border:1px solid rgba(148,163,184,.15); border-radius:16px; padding:20px; box-shadow: 0 20px 60px rgba(0,0,0,.35); }
    h1 { font-size: 22px; margin:0 0 6px; }
    p { margin: 0 0 14px; color: var(--muted); }
    .row { display:grid; grid-template-columns: 1fr 1fr; gap:16px; }
    @media (max-width: 820px){ .row { grid-template-columns: 1fr; } }
    .pane { background: rgba(2,6,23,.35); border:1px dashed rgba(148,163,184,.25); border-radius:14px; padding:14px; }
    .pane h2 { font-size: 14px; color: var(--muted); margin:0 0 10px; font-weight:600; letter-spacing:.02em; }
    .controls { display:flex; flex-wrap:wrap; gap:10px; align-items:center; margin-bottom: 12px; }
    input[type=file] { color: var(--muted); }
    .btn { cursor:pointer; border:1px solid rgba(148,163,184,.25); background: rgba(96,165,250,.12); color: var(--text); padding:10px 12px; border-radius:12px; font-weight:600; }
    .btn:disabled { opacity:.5; cursor:not-allowed; }
    canvas, img { width: 100%; height: auto; border-radius: 12px; display:block; background: rgba(0,0,0,.2); }
    .footer { margin-top: 14px; font-size: 12px; color: var(--muted); }
    .pill { display:inline-block; padding: 2px 8px; border:1px solid rgba(148,163,184,.25); border-radius:999px; font-size:12px; color: var(--muted); }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1>Photo LinkedIn → Noir & Blanc</h1>
      <p>Upload un selfie, on le convertit en noir & blanc (localement dans ton navigateur), puis tu télécharges le résultat.</p>

      <div class="controls">
        <input id="file" type="file" accept="image/*" />
        <button id="download" class="btn" disabled>Télécharger le PNG</button>
        <span class="pill" id="status">En attente d’une image…</span>
      </div>

      <div class="row">
        <div class="pane">
          <h2>Original</h2>
          <img id="preview" alt="Aperçu original" />
        </div>
        <div class="pane">
          <h2>Noir & Blanc</h2>
          <canvas id="out"></canvas>
        </div>
      </div>

      <div class="footer">
        Astuce : pour LinkedIn, vise un cadrage tête + épaules. Rien n’est envoyé sur un serveur.
      </div>
    </div>
  </div>

<script>
  const fileInput = document.getElementById('file');
  const preview = document.getElementById('preview');
  const canvas = document.getElementById('out');
  const downloadBtn = document.getElementById('download');
  const statusEl = document.getElementById('status');
  const ctx = canvas.getContext('2d', { willReadFrequently: true });

  function setStatus(t){ statusEl.textContent = t; }

  function toGrayscale(img){
    const w = img.naturalWidth;
    const h = img.naturalHeight;
    canvas.width = w;
    canvas.height = h;
    ctx.drawImage(img, 0, 0, w, h);

    const imageData = ctx.getImageData(0, 0, w, h);
    const d = imageData.data;

    // Rec. 709 luma coefficients
    for (let i = 0; i < d.length; i += 4) {
      const r = d[i], g = d[i+1], b = d[i+2];
      const y = Math.round(0.2126*r + 0.7152*g + 0.0722*b);
      d[i] = d[i+1] = d[i+2] = y;
      // alpha stays
    }

    ctx.putImageData(imageData, 0, 0);
  }

  fileInput.addEventListener('change', async () => {
    const f = fileInput.files?.[0];
    if (!f) return;

    setStatus('Chargement…');
    downloadBtn.disabled = true;

    const url = URL.createObjectURL(f);
    preview.src = url;

    await new Promise((resolve, reject) => {
      preview.onload = resolve;
      preview.onerror = reject;
    });

    toGrayscale(preview);
    setStatus('Prêt ✅');
    downloadBtn.disabled = false;
  });

  downloadBtn.addEventListener('click', () => {
    const a = document.createElement('a');
    a.download = 'linkedin-noir-et-blanc.png';
    a.href = canvas.toDataURL('image/png');
    a.click();
  });
</script>
</body>
</html>
